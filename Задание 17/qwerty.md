# Задание №17
# Задача о максимальном потоке минимальной стоимости.

Для каждого варианта представлены условия задачи, в соответствии с которыми необходимо: 
1. Построить сеть с указанием пропускной способности дуг.
2. Построить остаточную сеть.
3. Определить максимальный поток методом поиска увеличивающих путей в остаточной сети (**строго** так, как было разобрано на занятиях).
4. Минимизировать стоимость максимального потока посредством поиска циклов отрицательной стоимости (**решение необходимо построить так, чтобы найти и обработать как минимум один цикл отрицательной стоимости**).
5. Оформить решение задачи по шагам с подробными комментариями, таблицами и диаграммами.
6. В ответе указать максимальную величину потока, минимальную стоимость транспортировки и сеть с указанием соответствующих локальных потоков.
---

## Вариант 8:
#### Пропускная способность дуг сети p(e) и стоимость транспортировки  единицы потока c(e):

| Дуги                                          | sa | sb | ac | ba | bc | bd | cd | dt |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность p(e)                   | 3  | 10 | 4  | 1  | 3  | 10 | 8  | 12 |
| Стоимость транспортировки единицы потока c(e) | 1  | 1  | 1  | 2  | 3  | 5  | 1  | 1  |
---
## Решение
### Часть 1. Поиск максимального потока.

#### 1. Построим согласно таблице сеть с источником s, стоком t и указанными пропускными способностями.

<img width="619" height="276" alt="image" src="https://github.com/user-attachments/assets/54499a19-d4cb-4515-a0fd-61e082153627" />

Выберем начальный поток величиной 3 на пути $s \rightarrow a \rightarrow c \rightarrow d \rightarrow t$.

<img width="626" height="261" alt="image" src="https://github.com/user-attachments/assets/b6229546-65dc-45a8-825c-2c2963fd33c3" />

#### 2. Построим соответствующую остаточную сеть.

В ней выделим существующий начальный поток.

<img width="616" height="281" alt="image" src="https://github.com/user-attachments/assets/9847ea8d-b84e-4375-a01c-cac923239e75" />

#### 3. Выполним поиск увеличивающего пути в остаточной сети.
Найден увеличивающий путь $t \rightarrow d \rightarrow b \rightarrow s$. Минимальный вес в этом пути - 9.

<img width="618" height="277" alt="image" src="https://github.com/user-attachments/assets/66471b51-e081-4c23-a918-a7a4d923d81e" />

Уменьшим вес дуг на найденном пути на 9, дугу $t \rightarrow d$ с нулевым весом из графа удалим.

<img width="606" height="282" alt="image" src="https://github.com/user-attachments/assets/3779b06e-51b1-41f6-add6-0c6ce5eb29a7" />

Повторно выполним поиск увеличивающего пути в остаточной сети. Увеличивающих путей больше нет, следовательно, найденный поток в сети является **максимальным**.

<img width="631" height="272" alt="image" src="https://github.com/user-attachments/assets/83b01f9a-9018-4675-844d-48e02e7fbd81" />

#### 4. Отобразим изменения в исходной сети. 
Величина потока составляет 3 + 9 = 12, и это значение для данной сети является максимальным.

<img width="612" height="272" alt="image" src="https://github.com/user-attachments/assets/f4e6db57-0ac8-4c69-b52f-deeac266cb22" />

---

### Часть 2. Минимизация стоимости максимального потока.

#### 1. Рассчитаем текущую стоимость максимального потока.

| Дуги                                          | sa | sb | ac | ba | bc | bd | cd | dt | **Итого** |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:---------:|
| Пропускная способность p(e)                   | 3  | 10 | 4  | 1  | 3  | 10 | 8  | 12 |           |
| Локальный поток f(e)                          | 3  | 9  | 3  | 0  | 0  | 9  | 3  | 12 |           |
| Стоимость транспортировки единицы потока c(e) | 1  | 1  | 1  | 2  | 3  | 5  | 1  | 1  |           |
| Суммарная стоимость f(e)*c(e)                 | 3  | 9  | 3  | 0  | 0  | 45 | 3  | 12 |  **75**   |

Стоимость полученного потока составляет 75. Попробуем эту стоимость минимизировать с помощью поиска ориентированных циклов с отрицательной стоимостью.

#### 2. Построим остаточную сеть с указанием стоимости транспортировки единицы потока вдоль данной дуги.

<img width="627" height="269" alt="image" src="https://github.com/user-attachments/assets/51fd4373-effa-4fa3-ac12-c7d1d12107d5" />

#### 3. Выполним в остаточной сети поиск ориентированных циклов с отрицательной суммарной стоимостью.

Такой цикл найден, он задаётся путём $a \rightarrow b \rightarrow d \rightarrow c \rightarrow a$, его общая стоимость составляет $1-5+1+1=-2$.

<img width="618" height="268" alt="image" src="https://github.com/user-attachments/assets/ad6ab76d-f0b8-46ca-a4c7-3f4593f84ab5" />

Определим минимальный вес рёбер этого цикла в **остаточном сети с указанием величин потоков**. Минимальный вес равен 1.

<img width="612" height="279" alt="image" src="https://github.com/user-attachments/assets/2a4bd2d7-423b-412f-9a33-17c4b15e6083" />

Уменьшим на 1 вес всех рёбер найденного цикла, рёбра с нулевым весом из графа удалим.

<img width="645" height="274" alt="image" src="https://github.com/user-attachments/assets/02d34075-f83c-4c7b-a167-a7772a47e056" />

Скорректируем соответствующим образом **остаточную сеть с указанием стоимости транспортировки**.

<img width="634" height="272" alt="image" src="https://github.com/user-attachments/assets/1ecbc474-d31c-4b81-9994-53a1f6ce173e" />

#### 4. Повторно выполним поиск ориентированных циклов с отрицательной стоимостью.

Найден цикл $b \rightarrow d \rightarrow c \rightarrow b$, его стоимость составляет $3-5+1=-1$.

<img width="630" height="285" alt="image" src="https://github.com/user-attachments/assets/b1b0c6b9-bf4d-405f-ad29-a96d53333a71" />

В **остаточной сети с указанием величин потоков** определим минимальный вес ребра в этом цикле, он равен 3.

<img width="608" height="265" alt="image" src="https://github.com/user-attachments/assets/90c58868-4576-47c2-8ea7-b72b788a9967" />

Уменьшим на 3 веса всех дуг в этом цикле, нулевую дугу из графа удалим.

<img width="616" height="252" alt="image" src="https://github.com/user-attachments/assets/8125ff72-096d-4082-ac56-599330ebe69e" />

Скорректируем соответствующим образом **остаточную сеть с указанием стоимости траснпортировки**.

<img width="603" height="276" alt="image" src="https://github.com/user-attachments/assets/1e7786e3-ed18-4357-9c0f-9aa969246c35" />

#### 5. Повторно выполним поиск ориентированных циклов с отрицательной стоимостью.

В остаточной сети больше нет циклов отрицательной стоимости, следовательно, текущая стоимость потока является минимальной. Отобразим изменения остаточной сети в исходной сети.

<img width="612" height="275" alt="image" src="https://github.com/user-attachments/assets/4acbb810-8845-43b1-8bdd-6c4db991ca0e" />

#### 6. Рассчитаем минимальную стоимость максимального потока.

| Дуги                                          | sa | sb | ac | ba | bc | bd | cd | dt | **Итого** |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:---------:|
| Пропускная способность p(e)                   | 3  | 10 | 4  | 1  | 3  | 10 | 8  | 12 |           |
| Локальный поток f(e)                          | 3  | 9  | 4  | 1  | 3  | 5  | 7  | 12 |           |
| Стоимость транспортировки единицы потока c(e) | 1  | 1  | 1  | 2  | 3  | 5  | 1  | 1  |           |
| Суммарная стоимость f(e)*c(e)                 | 3  | 9  | 4  | 2  | 9  | 25 | 7  | 12 |  **71**   |

Стоимость полученного потока равна 71.

---

## Ответ:

Максимальный поток в сети равен 12. Минимальная стоимость этого потока составляет 71 и достигается при следующих локальных потоках:

<img width="612" height="275" alt="image" src="https://github.com/user-attachments/assets/4acbb810-8845-43b1-8bdd-6c4db991ca0e" />
