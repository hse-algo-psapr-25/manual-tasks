# Задание №17

# Задача о максимальном потоке минимальной стоимости.

## Постановка задачи

1. Дана сеть (взвешенный ориентированный граф) с источником s и стоком t.
2. Для каждой дуги определена пропускная способность и стоимость транспортировки.
3. Необходимо найти для указанной сети максимальный поток минимальной стоимости.

### Вариант 9:

#### Пропускная способность дуг сети p(e) и стоимость транспортировки единицы потока c(e):

| Дуги                                          | sa | sb | sc | ba | bc | cd | ac | ad | dt |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность p(e)                   | 6  | 6  | 6  | 6  | 5  | 10 | 5  | 8  | 12 |
| Стоимость транспортировки единицы потока c(e) | 1  | 1  | 3  | 1  | 1  | 1  | 3  | 4  | 1  |

### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг для поиска максимального потока.

![alt text](../assets/NoName-1.png)

### 2. Найдем максимальный поток


Начальный поток ведичиной 6 S → A → D → T

![alt text](../assets/NoName-2.png)

Построим соответствующую остаточную сеть

![alt text](../assets/NoName-3.png)

2. Поиск увеличивающего пути

В остаточной сети найден путь:

s → b → c → d → t 
min(6,5,10,6)=5

![alt text](../assets/NoName-4.png)

Корректируем остаточную сеть

![alt text](../assets/NoName-5.png)

Построим соответствующую остаточную сеть

![alt text](../assets/NoName-6.png)

## Продолжим поиск увеличивающего пути
Найден путь:
s → c → d → t                
min(6,5,1)=1

![alt text](../assets/NoName-7.png)

Корректировка

![alt text](../assets/NoName-8.png)

Максимальный поток:

6+5+1=126 + 5 + 1 = 126+5+1=12

### 3. Рассчитаем стоимость полученного максимального потока

| Дуги                                           |  sa |  sb | sc | ba  | bc  | cd  |  ac | ad | dt | Итого|
|:-----------------------------------------------|:---:|:---:|:--:|:---:|:---:|:---:|:---:|:--:|:--:|:-----:
| Пропускная способность p(e)                    |  6  |  6  | 6  |  6  |  5  |  10 |  5  |  8 | 12 |
| Локальный поток f(e)                           |  6  |  5  | 1  |  0  |  5  |  6  |  0  |  6 | 12 |
| Стоимость транспортировки единицы потока c(e)  |  1  |  1  | 3  |  1  |  1  |  1  |  3  |  4 |  1 |
| Суммарная стоимость f(e)*c(e)                  |  6  |  5  | 3  |  0  |  5  |  6  |  0  | 24 | 12 |**61**|

Стоимость полученного потока составляет 61.

### 4. Попробуем уменьшить стоимость потока для чего построим остаточную сеть

Ищем отрицательный цикл.

![alt text](../assets/NoName-9.png)

Отрицательного цикла в остаточной сети нет, следовательно, стоимость потока минимальна.

### 5. Рассчитаем стоимость полученного максимального потока.

| Дуги                                           |  sa |  sb | sc | ba  | bc  | cd  |  ac | ad | dt | Итого|
|:-----------------------------------------------|:---:|:---:|:--:|:---:|:---:|:---:|:---:|:--:|:--:|:-----:
| Пропускная способность p(e)                    |  6  |  6  | 6  |  6  |  5  |  10 |  5  |  8 | 12 |
| Локальный поток f(e)                           |  6  |  5  | 1  |  0  |  5  |  6  |  0  |  6 | 12 |
| Стоимость транспортировки единицы потока c(e)  |  1  |  1  | 3  |  1  |  1  |  1  |  3  |  4 |  1 |
| Суммарная стоимость f(e)*c(e)                  |  6  |  5  | 3  |  0  |  5  |  6  |  0  | 24 | 12 |**61**|

Стоимость полученного потока составляет 61.

### Ответ:

Максимальный поток в сети равен 12, минимальная стоимость потока 61
и он реализуется следующим локальными потоками:

![alt text](../assets/NoName-10.png)
