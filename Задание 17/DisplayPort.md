# Задание №17

# Вариант №1

# Задача о максимальном потоке минимальной стоимости.

1. Дана сеть (взвешенный ориентированный граф) с источником s и стоком t.
2. Для каждой дуги определена пропускная способность и стоимость транспортировки.
3. Необходимо найти для указанной сети максимальный поток минимальной стоимости.

#### Пропускная способность дуг сети (p(e)) и стоимость транспортировки единицы потока (c(e)):

| Дуги                                          | sa  | sb  | sc  | ac  | ad  | ab  | bd  | ct  | dt  |
| :-------------------------------------------- | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
| Пропускная способность p(e)                   | 10  | 10  |  5  |  7  |  8  |  5  |  8  | 10  | 10  |
| Стоимость транспортировки единицы потока c(e) |  1  |  1  |  1  |  2  |  3  |  1  |  1  |  2  |  1  |

---

### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг для поиска максимального потока.

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|10| a
    s -->|10| b
    s -->|5| c
    a -->|7| c
    a -->|8| d
    a -->|5| b
    b -->|8| d
    c -->|10| t
    d -->|10| t

```

### 2. Построим остаточную сеть

```mermaid
graph RL
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    a -->|10| s
    b -->|10| s
    c -->|5| s
    c -->|7| a
    d -->|8| a
    b -->|5| a
    d -->|8| b
    t -->|10| c
    t -->|10| d

```

### 3. Поиск увеличивающих путей (поиск из t в s)

**Путь 1:** t → c → s, минимальный поток = 5.

```mermaid
graph RL
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    a -->|10| s
    b -->|10| s
    c -->|5| s
    c -->|7| a
    d -->|8| a
    b -->|5| a
    d -->|8| b
    t -->|10| c
    t -->|10| d
    
    linkStyle 2 stroke:red,stroke-width:4px
    linkStyle 7 stroke:red,stroke-width:4px

```

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|0,10| a
    s -->|0,10| b
    s -->|5,5| c
    a -->|0,7| c
    a -->|0,8| d
    a -->|0,5| b
    b -->|0,8| d
    c -->|5,10| t
    d -->|0,10| t
    
    linkStyle 2 stroke:red,stroke-width:4px
    linkStyle 7 stroke:red,stroke-width:4px

```

**Путь 2:** t → d → b → s, минимальный поток = 8.

```mermaid
graph RL
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    a -->|10| s
    b -->|10| s
    c -->|7| a
    d -->|8| a
    b -->|5| a
    d -->|8| b
    t -->|5| c
    t -->|10| d
    
    s -->|5| c
    c -->|5| t
    
    linkStyle 7 stroke:red,stroke-width:4px
    linkStyle 5 stroke:red,stroke-width:4px
    linkStyle 1 stroke:red,stroke-width:4px

```

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|0,10| a
    s -->|8,10| b
    s -->|5,5| c
    a -->|0,7| c
    a -->|0,8| d
    a -->|0,5| b
    b -->|8,8| d
    c -->|5,10| t
    d -->|8,10| t
    
    linkStyle 1 stroke:red,stroke-width:4px
    linkStyle 6 stroke:red,stroke-width:4px
    linkStyle 8 stroke:red,stroke-width:4px

```

**Путь 3:** t → d → a → s, минимальный поток = 2.

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    a -->|10| s
    b -->|2| s
    c -->|7| a
    d -->|8| a
    b -->|5| a
    t -->|5| c
    t -->|2| d
    
    s -->|5| c
    c -->|5| t
    s -->|8| b
    b -->|8| d
    d -->|8| t
    
    linkStyle 6 stroke:red,stroke-width:4px
    linkStyle 3 stroke:red,stroke-width:4px
    linkStyle 0 stroke:red,stroke-width:4px

```

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|2,10| a
    s -->|8,10| b
    s -->|5,5| c
    a -->|0,7| c
    a -->|2,8| d
    a -->|0,5| b
    b -->|8,8| d
    c -->|5,10| t
    d -->|10,10| t
    
    linkStyle 0 stroke:red,stroke-width:4px
    linkStyle 4 stroke:red,stroke-width:4px
    linkStyle 8 stroke:red,stroke-width:4px

```

**Путь 4:** t → c → a → s, минимальный поток = 5.

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    a -->|8| s
    b -->|2| s
    c -->|7| a
    d -->|6| a
    b -->|5| a
    t -->|5| c
    
    s -->|5| c
    c -->|5| t
    s -->|8| b
    b -->|8| d
    d -->|10| t
    s -->|2| a
    a -->|2| d
    
    linkStyle 5 stroke:red,stroke-width:4px
    linkStyle 2 stroke:red,stroke-width:4px
    linkStyle 0 stroke:red,stroke-width:4px

```

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|7,10| a
    s -->|8,10| b
    s -->|5,5| c
    a -->|5,7| c
    a -->|2,8| d
    a -->|0,5| b
    b -->|8,8| d
    c -->|10,10| t
    d -->|10,10| t
    
    linkStyle 0 stroke:red,stroke-width:4px
    linkStyle 3 stroke:red,stroke-width:4px
    linkStyle 7 stroke:red,stroke-width:4px

```

В остаточной сети не найдено увеличивающих путей (дуги, ведущие в сток t, полностью насыщены), следовательно, алгоритм завершил работу и найденный поток величиной 20 является максимальным для данной сети.

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    a -->|3| s
    b -->|2| s
    c -->|2| a
    d -->|6| a
    b -->|5| a
    
    s -->|7| a
    s -->|8| b
    s -->|5| c
    a -->|5| c
    a -->|2| d
    b -->|8| d
    c -->|10| t
    d -->|10| t

```

### 4. Рассчитаем стоимость полученного максимального потока.

| Дуги | sa | sb | sc | ac | ad | ab | bd | ct | dt |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Пропускная способность p(e) | 10 | 10 | 5 | 7 | 8 | 5 | 8 | 10 | 10 |
| Локальный поток f(e) | 7 | 8 | 5 | 5 | 2 | 0 | 8 | 10 | 10 |
| Стоимость транспортировки единицы потока c(e) | 1 | 1 | 1 | 2 | 3 | 1 | 1 | 2 | 1 |
| Суммарная стоимость f(e)*c(e) | 7 | 8 | 5 | 10 | 6 | 0 | 8 | 20 | 10 |

Итог 74

### 5. Попробуем уменьшить стоимость потока для чего построим остаточную сеть.

Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

```mermaid
graph LR
    s(((s)))
    a((a))
    b((b))
    c((c))
    d((d))
    t(((t)))

    a -->|1| s
    b -->|1| s
    c -->|-1| a
    d -->|-1| b
    t -->|-2| c
    t -->|-1| d
    
    s -->|-1| a
    s -->|-1| b
    s -->|-1| c
    a -->|2| c
    a -->|3| d
    a -->|1| b
    d -->|-3| a
    c -->|-2| a

```

Проведем поиск цикла отрицательной стоимости в остаточной сети.
В остаточной сети отсутствуют циклы отрицательной стоимости. Следовательно, стоимость потока минимальна.

### Ответ:

Максимальный поток в сети равен 20, минимальная стоимость потока 74, она реализуется следующим локальными потоками:

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|7,10| a
    s -->|8,10| b
    s -->|5,5| c
    a -->|5,7| c
    a -->|2,8| d
    a -->|0,5| b
    b -->|8,8| d
    c -->|10,10| t
    d -->|10,10| t

```