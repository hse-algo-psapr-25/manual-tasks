## Задание №16
## Задача о максимальном потоке.

### Вариант 6
#### Пропускная способность дуг сети:

|          Дуги          | sa | sb | sc | ba | bc | cd | dt | ac | at |
|:----------------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность | 6  | 4  | 6  | 5  | 5  | 10 | 8  | 5  | 8  |

### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг.

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|6| a
    s -->|4| b
    s -->|6| c
    b -->|5| a
    b -->|5| c
    c -->|10| d
    d -->|8| t
    a -->|5| c
    a -->|8| t
```

Построим начальную остаточную сеть. Все потоки нулевые, поэтому проводим обратные дуги

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    a -->|6| s
    b -->|4| s
    c -->|6| s
    a -->|5| b
    c -->|5| b
    d -->|10| c
    t -->|8| d
    c -->|5| a
    t -->|8| a
```

### 2. Проведем поиск увеличивающего пути в остаточной сети

В остаточной сети найден увеличивающий путь t -> a -> s. Минимальный вес дуг на пути: min(8, 6) = 6

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    a -->|6| s
    b -->|4| s
    c -->|6| s
    a -->|5| b
    c -->|5| b
    d -->|10| c
    t -->|8| d
    c -->|5| a
    t -->|8| a

    linkStyle 8,0 stroke:#d62728,stroke-width:3px
```

Уменьшим веса дуг на найденном пути и добавим обратные дуги для уже проведенного потока

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|6| a
    b -->|4| s
    c -->|6| s
    a -->|5| b
    c -->|5| b
    d -->|10| c
    t -->|8| d
    c -->|5| a
    t -->|2| a
    a -->|6| t
```

Скорректируем локальные потоки в исходной сети

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|6/6| a
    s -->|0/4| b
    s -->|0/6| c
    b -->|0/5| a
    b -->|0/5| c
    c -->|0/10| d
    d -->|0/8| t
    a -->|0/5| c
    a -->|6/8| t
```

### 3. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети найден увеличивающий путь t -> d -> c -> s. Минимальный вес дуг на пути: min(8, 10, 6) = 6

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|6| a
    b -->|4| s
    c -->|6| s
    a -->|5| b
    c -->|5| b
    d -->|10| c
    t -->|8| d
    c -->|5| a
    t -->|2| a
    a -->|6| t

    linkStyle 6,5,2 stroke:#d62728,stroke-width:3px
```

После уменьшения весов по пути получим такую остаточную сеть

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|6| a
    b -->|4| s
    s -->|6| c
    a -->|5| b
    c -->|5| b
    d -->|4| c
    c -->|6| d
    t -->|2| d
    d -->|6| t
    c -->|5| a
    t -->|2| a
    a -->|6| t
```

Скорректируем локальные потоки в исходной сети

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|6/6| a
    s -->|0/4| b
    s -->|6/6| c
    b -->|0/5| a
    b -->|0/5| c
    c -->|6/10| d
    d -->|6/8| t
    a -->|0/5| c
    a -->|6/8| t
```

### 4. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети найден увеличивающий путь t -> a -> b -> s. Минимальный вес дуг на пути: min(2, 5, 4) = 2

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|6| a
    b -->|4| s
    s -->|6| c
    a -->|5| b
    c -->|5| b
    d -->|4| c
    c -->|6| d
    t -->|2| d
    d -->|6| t
    c -->|5| a
    t -->|2| a
    a -->|6| t

    linkStyle 10,3,1 stroke:#d62728,stroke-width:3px
```

После уменьшения весов по пути получим такую остаточную сеть

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|6| a
    b -->|2| s
    s -->|2| b
    s -->|6| c
    a -->|3| b
    b -->|2| a
    c -->|5| b
    d -->|4| c
    c -->|6| d
    t -->|2| d
    d -->|6| t
    c -->|5| a
    a -->|8| t
```

Скорректируем локальные потоки в исходной сети

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|6/6| a
    s -->|2/4| b
    s -->|6/6| c
    b -->|2/5| a
    b -->|0/5| c
    c -->|6/10| d
    d -->|6/8| t
    a -->|0/5| c
    a -->|8/8| t
```

### 5. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети найден увеличивающий путь t -> d -> c -> b -> s. Минимальный вес дуг на пути: min(2, 4, 5, 2) = 2

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|6| a
    b -->|2| s
    s -->|2| b
    s -->|6| c
    a -->|3| b
    b -->|2| a
    c -->|5| b
    d -->|4| c
    c -->|6| d
    t -->|2| d
    d -->|6| t
    c -->|5| a
    a -->|8| t

    linkStyle 9,7,6,1 stroke:#d62728,stroke-width:3px
```

После уменьшения весов по пути получим такую остаточную сеть

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|6| a
    s -->|4| b
    s -->|6| c
    a -->|3| b
    b -->|2| a
    c -->|3| b
    b -->|2| c
    d -->|2| c
    c -->|8| d
    d -->|8| t
    c -->|5| a
    a -->|8| t
```

Скорректируем локальные потоки в исходной сети

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|6/6| a
    s -->|4/4| b
    s -->|6/6| c
    b -->|2/5| a
    b -->|2/5| c
    c -->|8/10| d
    d -->|8/8| t
    a -->|0/5| c
    a -->|8/8| t
```

### 6. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети больше нет увеличивающих путей(из вершины t не выходит ни одной дуги), значит алгоритм завершен

```mermaid
graph LR
    s((s))
    a((a))
    b((b))
    c((c))
    d((d))
    t((t))

    s -->|6| a
    s -->|4| b
    s -->|6| c
    a -->|3| b
    b -->|2| a
    c -->|3| b
    b -->|2| c
    d -->|2| c
    c -->|8| d
    d -->|8| t
    c -->|5| a
    a -->|8| t
```

Следовательно, найденный поток является максимальным и равняется 16

### 7. Проверим значение максимального потока перебором всех разрезов сети.

В сети 6 вершин, значит число разрезов равно 2^(n-2) = 2^(6-2) = 16

| №  | V<sub>1</sub>         | V<sub>2</sub>      | Пропускная способность разреза |
|:--:|:----------------------|:-------------------|:------------------------------:|
| 1  | s                     | a, b, c, d, t      |        6 + 4 + 6 = 16          |
| 2  | s, a                  | b, c, d, t         |      4 + 6 + 5 + 8 = 23        |
| 3  | s, b                  | a, c, d, t         |      6 + 6 + 5 + 5 = 22        |
| 4  | s, c                  | a, b, d, t         |       6 + 4 + 10 = 20          |
| 5  | s, d                  | a, b, c, t         |      6 + 4 + 6 + 8 = 24        |
| 6  | s, a, b               | c, d, t            |      6 + 5 + 5 + 8 = 24        |
| 7  | s, a, c               | b, d, t            |        4 + 10 + 8 = 22         |
| 8  | s, a, d               | b, c, t            |    4 + 6 + 8 + 5 + 8 = 31      |
| 9  | s, b, c               | a, d, t            |       6 + 5 + 10 = 21          |
| 10 | s, b, d               | a, c, t            |    6 + 6 + 5 + 5 + 8 = 30      |
| 11 | s, c, d               | a, b, t            |        6 + 4 + 8 = 18          |
| 12 | s, a, b, c            | d, t               |          10 + 8 = 18           |
| 13 | s, a, b, d            | c, t               |    6 + 5 + 8 + 5 + 8 = 32      |
| 14 | s, a, c, d            | b, t               |         4 + 8 + 8 = 20         |
| 15 | s, b, c, d            | a, t               |         6 + 5 + 8 = 19         |
| 16 | s, a, b, c, d         | t                  |          8 + 8 = 16            |

Минимальная пропускная способность разреза равна 16 (разрезы №1 и №16), что совпадает с найденным максимальным потоком

### Ответ

Максимальный поток в сети равен 16