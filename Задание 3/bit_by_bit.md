
# Задание 3 — Распределение инвестиций методом динамического программирования
 

## Постановка задачи

Дана таблица совокупной прибыли $в у.е.$ при вложении фиксированных долей бюджета в проекты A, B, C, D.  
Шаг инвестирования — **20**, общий бюджет — **100**. При вложении 0 в проект прибыль равна 0.

## Вариант 1:

| Вложение | A | B | C | D |
|:--:|--:|--:|--:|--:|
| 20 | 7 | 2 | 1 | 4 |
| 40 | 9 | 10 | 12 | 13 |
| 60 | 11 | 13 | 14 | 16 |
| 80 | 17 | 15 | 15 | 18 |
| 100| 21 | 22 | 19 | 19 |

**Требуется:** распределить 100 у.е. между проектами, чтобы максимизировать суммарную прибыль, и показать подробный ход решения.

---

## Обозначения и идея алгоритма

Обозначим $P_Xx$ — прибыль проекта $X \in \{A,B,C,D\}$ при вложении $x \in \{0,20,40,60,80,100\}$ и $P_X0=0$.  
Пусть $f_ks$ — максимальная прибыль при распределении суммы $s$ между первыми $k$ проектами.

**Переход Беллмана:**
$$
f_k(s) = \max_{x \in \{0,20,\dots,s\}} \Big( f_{k-1}(s-x) + P_k(x) \Big)
$$
Одновременно сохраняем аргумент максимума $сколько выделили текущему проекту$ для восстановления плана.

Состояния: $s \in \{0,20,40,60,80,100\}$, проектов 4 → удобно вести по проектам A→B→C→D.

---

## Шаг 1. Только проект A: $f_1s=P_As$

| s | 0 | 20 | 40 | 60 | 80 | 100 |
|---:|---:|---:|---:|---:|---:|---:|
| $f_1s$ | 0 | 7 | 9 | 11 | 17 | 21 |

---

## Шаг 2. Проекты A + B: расчёт $f_2s$

Для каждого $s$ перебираем $x_B\in\{0,20,\dots,s\}$ и считаем $f_1s-x_B+P_Bx_B$.

**Полный перебор $показываем сравнения$:**

- s=20: max{ $7, 2$ } → **7** при $x_B=0$  
- s=40: max{ $9, 7+2=9, 10$ } → **10** при $x_B=40$  
- s=60: max{ $11, 9+2=11, 7+10=17, 13$ } → **17** при $x_B=40$  
- s=80: max{ $17, 11+2=13, 9+10=19, 7+13=20, 15$ } → **20** при $x_B=60$  
- s=100: max{ $21, 17+2=19, 11+10=21, 9+13=22, 7+15=22, 22$ } → **22** $одно из оптимальных: $x_B=60$

Итоговые значения и решения:
| s | 0 | 20 | 40 | 60 | 80 | 100 |
|---:|---:|---:|---:|---:|---:|---:|
| $f_2s$ | 0 | 7 | 10 | 17 | 20 | 22 |
| оптимальный $x_B$ | 0 | 0 | 40 | 40 | 60 | 60 |

---

## Шаг 3. Проекты A + B + C: расчёт $f_3s$

Перебираем $x_C$.

- s=20: max{ $7, 1$ } → **7** при $x_C=0$  
- s=40: max{ $10, 7+1=8, 12$ } → **12** при $x_C=40$  
- s=60: max{ $17, 10+1=11, 7+12=19, 14$ } → **19** при $x_C=40$  
- s=80: max{ $20, 17+1=18, 10+12=22, 7+14=21, 15$ } → **22** при $x_C=40$  
- s=100: max{ $22, 20+1=21, 17+12=29, 10+14=24, 7+15=22, 19$ } → **29** при $x_C=40$

Итого:
| s | 0 | 20 | 40 | 60 | 80 | 100 |
|---:|---:|---:|---:|---:|---:|---:|
| $f_3s$ | 0 | 7 | 12 | 19 | 22 | 29 |
| оптимальный $x_C$ | 0 | 0 | 40 | 40 | 40 | 40 |

---

## Шаг 4. Проекты A + B + C + D: итог $f_4s$

Перебираем $x_D$.

- s=20: max{ $7, 4$ } → **7** при $x_D=0$  
- s=40: max{ $12, 7+4=11, 13$ } → **13** при $x_D=40$  
- s=60: max{ $19, 12+4=16, 7+13=20, 16$ } → **20** при $x_D=40$  
- s=80: max{ $22, 19+4=23, 12+13=25, 7+16=23, 18$ } → **25** при $x_D=40$  
- s=100: max{ $29, 22+4=26, 19+13=32, 12+16=28, 7+18=25, 19$ } → **32** при $x_D=40$

Итог:
| s | 0 | 20 | 40 | 60 | 80 | 100 |
|---:|---:|---:|---:|---:|---:|---:|
| $f_4s$ | 0 | 7 | 13 | 20 | 25 | **32** |
| оптимальный $x_D$ | 0 | 0 | 40 | 40 | 40 | **40** |

---

## Восстановление оптимального распределения $обратный ход$

- Из $f_4100$: $x_D=40$ → **D=40**, остаток $s=60$.  
- Из $f_360$: $x_C=40$ → **C=40**, остаток $s=20$.  
- Из $f_220$: $x_B=0$ → **B=0**, остаток $s=20$.  
- Остаток идёт в A → **A=20**.

**Проверка прибыли:** $A20=7$; $B0=0$; $C40=12$; $D40=13$.  
Сумма: $7+0+12+13 = \mathbf{32}$.

---

## Ответ

- **Максимальная прибыль:** **32**.  
- **Оптимальное распределение бюджета 100:**  
  - **A — 20**, **B — 0**, **C — 40**, **D — 40**.

---

## Корректность и трудоёмкость

- Оптимальность следует из принципа Беллмана (оптимальная подструктура + полный перебор разбиений на каждом шаге).  
- Оценка сложности: пусть проектов $n$, значений суммы $m=S/\Delta+1$. Тогда порядка $On,m^2$.  
  В наших данных: $n=4$, $m=6$ → $4*6^2=144$ сравнений.

> Примечание. На промежуточных шагах могли быть несколько равных по прибыли разбиений $напр., $f_2100=22$, однако после добавления проектов C и D итоговое распределение единственно при шаге 20.
